// Document generated by render-adoc.go from partials/odsComponentStageScanWithTrivy.adoc.tmpl; DO NOT EDIT.

The "Trivy Security Scan" stage scans the filesystem of the cloned repository using https://github.com/aquasecurity/trivy[Trivy] and generates a https://cyclonedx.org/capabilities/sbom[SBOM] report, with https://cyclonedx.org/specification/overview/[CycloneDX] format by default. Check Trivy supported formats https://aquasecurity.github.io/trivy/latest/docs/supply-chain/sbom/[here].

As a result, a Bitbucket Code Insight entry is added to the git commit (in Bitbucket) that basically
contains a link to the scan report stored in Nexus. The Bitbucket Code Insight entry can be seen in a pull request.
The pull request in Bitbucket shows the Code Insight of the latest commit of the PR.

To get started, edit your `Jenkinsfile` and add the Trivy stage:
----
) { context ->
    ...
    odsComponentStageScanWithTrivy(context)
    ...
}
----

== Options

[cols="1,2"]
|===
| Option | Description


| *additionalFlags* +
_List<String>_
|Additional flags for the Trivy CLI. Please refer to the official Trivy CLI
 reference for possible options and don't forget to take the CLI version
 of your ODS installation into account. The value of `additionalFlags`
 must be a list in which the entries have the official flag name and a
 possible value.
 Example: `['--debug', '--timeout=10m']`


| *branch* +
_String_
|Branch to run stage for.
 Example: `'master'`.
 Next to exact matches, it also supports prefixes (e.g. `feature/`) and all branches (`*`).


| *branches* +
_List<String>_
|Branches to run stage for.
 Example: `['master', 'develop']`.
 Next to exact matches, it also supports prefixes (e.g. `feature/`) and all branches (`*`).


| *format* +
_String_
|Set the format for the generated report. Defaults to `cyclonedx`.


| *nexusDataBaseRepository* +
_String_
|Name of the Nexus repository used to proxy the location of the database of vulnerabilities located in GitHub.
 Defaults to `docker-group-ods`.


| *nexusReportRepository* +
_String_
|Name of the Nexus repository where the scan report will be stored. Defaults to `leva-documentation`.


| *pkgType* +
_String_
|Comma-separated list of vulnerability types to scan. Defaults to `os,library`.


| *reportFile* +
_String_
|Name of the file that will be archived in Jenkins and uploaded in Nexus.
 Defaults to `trivy-sbom.json`.


| *resourceName* +
_String_
|Name of component that we want to scan. Defaults to `context.componentId`.


| *scanners* +
_String_
|Comma-separated list of what security issues to detect. Defaults to `vuln,config,secret,license`.

|===
